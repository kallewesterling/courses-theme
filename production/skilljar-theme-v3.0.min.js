/*
 * Chainguard Courses Theme v3.0
 * This script applies custom styles and functionality to Chainguard's Skilljar platform.
 * It includes features like curriculum styling, lesson navigation, and responsive design adjustments.
 * It also provides utility functions for clipboard operations and element styling.
 *
 * This script is designed to be run in the context of a Skilljar page.
 *
 * @version 3.0
 * @date 2026-01-10
 * @author Chainguard
 * @license MIT
 * @see {@link https://courses.chainguard.com|Chainguard Courses}
 */
document.querySelector("body").style.setProperty("display","none");const placeholder=(e,t)=>{e&&null!=t?e.setAttribute("placeholder",t):logger.warn("placeholder(): Element is null or undefined. Tried to set placeholder to:",t)};function addCrumb(e,t,a=!1){a&&(t=`${CG.state.baseURL}${t}`),CG.state.crumbs.push([e,t])}function updateLinks(e){A('a[href*="'+CONFIG.domains.prod.url+'"], a[href*="'+CONFIG.domains.stage.url+'"]').forEach(t=>{const a=new URL(t.href);e&&a.hostname===CONFIG.domains.prod.url?a.hostname=CONFIG.domains.stage.url:e||a.hostname!==CONFIG.domains.stage.url||(a.hostname=CONFIG.domains.prod.url),t.href=a.toString()})}function addPartnerMenu(){const e=el("a",{href:"/page/partners",text:"Partner Courses"});CG.dom.headerLeft.appendChild(e),CG.dom.mobileHeader.left.appendChild(e.cloneNode(!0))}function debugHeading(){const e=el("div",{class:"align-vertical info-circle-wrapper"},[el("div",{class:"info-circle",text:"I"})]);CG.dom.headerRight.insertBefore(e,CG.dom.headerRight.firstChild);let t=[el("span",{text:"Handler: "+pageHandlers.find(({test:e})=>e).handler.name}),el("input",{type:"checkbox",id:"cg-baseurl-staging",checked:!!CG.env.isStaging}),CG.state.course.id?el("a",{href:CG.state.course.edit,text:"Edit Course"}):null,CG.state.course.path.id&&CG.state.domain?el("a",{href:CG.state.course.path.edit,text:"Edit Path"}):null].filter(Boolean).map(e=>el("li",{},[e]));const a=el("ul",{class:"info-circle-menu",hidden:!0},t);CG.dom.headerRight.parentElement.insertBefore(a,CG.dom.headerRight.parentElement.firstChild);const o=Q(".info-circle-wrapper"),r=Q(".info-circle-menu");o.addEventListener("click",()=>{const e=o.getBoundingClientRect().x-140;r.style.left=`${e}px`,r.hidden=!r.hidden});const n=Q("#cg-baseurl-staging");updateLinks(n.checked),n.addEventListener("change",function(){updateLinks(this.checked)})}function renderBreadcrumbs(e){if(!CG.state.crumbs||!Array.isArray(CG.state.crumbs)||0===CG.state.crumbs.length)return;e||(e=el("div",{id:"breadcrumbs",className:"row dp-row-flex-v2"}));const t=el("nav",{className:"breadcrumb","aria-label":"Breadcrumb",role:"navigation"},[el("ol",{},CG.state.crumbs.map(([e,t],a,o)=>{const r=a===o.length-1;return el("li",{},[el(r||!("#"!==t)?"span":"a",{className:"crumb",text:e,href:"#"===t?void 0:t,"aria-current":r?"page":void 0})])}))]);return e?.replaceChildren(t),e}function makeSections(e,t="#skilljar-content",a="https://courses.chainguard.dev"){e.forEach(e=>{const o=e=>{const t=(o=e.slug,CG.state.isRegistered(o)?"in-progress":"");var o;const r=(e=>CG.state.isCompleted(e)?"completed":"")(e.slug),n=`${r} ${t}`,s=r||t?el("span",{className:`pill ${n}`,text:r?"Completed":t?"In Progress":""}):void 0;return el("a",{className:"no-select",href:`${a}/${e.slug}`,title:e.isCourse?"Start course":"Start path"},[el("article",{className:n},[el("div",{className:"inner"},[s,el("div",{className:"icon"},[createClone(e.icon)]),el("h5",{text:e.isCourse?"Course":"Learning Path"},[el("span",{textContent:" | Free"})]),el("h3",{text:e.title}),el("p",{text:e.description}),e.hasBadge&&!r?el("span",{className:"pill badged",text:"Get a Badge"}):void 0].filter(Boolean))])])},r=el("section",{className:`featured-courses ${e.classNames?.join(" ")||""}`},[el("div",{className:"grid"},[el("div",{className:"intro"},[e.eyebrow?el("h2",{className:"eyebrow",text:e.eyebrow}):null,el("p",{className:"headline",text:e.title}),el("p",{className:"subhead",text:e.description})]),el("div",{className:"cards"},e.links.map(e=>o(e)))])].filter(Boolean));Q(t).append(r)})}function createClone(e="checkbox",t={}){if(!CONFIG.icons[e])return logger.error(`Icon type "${e}" not found in CONFIG.icons`),null;CONFIG.icons[e].attrs&&(t={...CONFIG.icons[e].attrs,...t}),t.className||(t.className=`clone-icon ${e}-icon`);const a=CONFIG.icons[e].paths.map(e=>el("path",{d:e}));return el("svg",t,a)}function createResourceCard(e={link:"#",title:"Resources",tags:[]}){return el("a",{href:getCorrectURL(e.link),target:"_blank",className:"resource-link-wrapper"},[el("div",{className:"resource-card"},[el("div",{className:"card-body"},[Array.isArray(e.tags)&&e.tags.length>0?el("div",{className:"badge-container"},e.tags.map(e=>el("div",{className:"badge",text:e}))):void 0,el("h5",{className:"card-title",text:e.title})].filter(Boolean))])])}function createCourseDetailsCard(e,t={btnText:"Register",btnHref:"#",completed:!1}){const a=el("div",{className:"course-card"},[el("h3",{className:"no-select",textContent:"Course Details"}),el("ul",{className:"no-select"},[el("li",{},[el("p",{text:e.audience})]),el("li",{},[el("p",{text:e.time})]),el("li",{},[el("p",{text:e.lessons+" Lessons"})])])]),o=el("a",{href:t.completed?"#":t.btnHref,textContent:t.completed?"ðŸŽ‰ Completed":t.btnText,className:"button "+(t.completed?"completed":"")});return setStyle(o,{marginLeft:"20px",marginRight:"20px"}),a.appendChild(o),t.completed&&a.append(el("p",{textContent:"Click on any lesson that you want to revisit.",className:"completed-subtext"})),a}function toClipboard(e,t){return async()=>{try{await navigator.clipboard.writeText(e),a=t,setStyle(a,{opacity:"1"}),setTimeout(()=>{setStyle(a,{opacity:"0"})},400)}catch(e){logger.error("Failed to copy codeblock to clipboard: ",e)}var a}}function tryPathSections(){pathSections[skilljarPath.slug]?(hide(".sj-courseboxes-v2"),makeSections(pathSections[skilljarPath.slug],"#skilljar-content",`${CG.state.baseURL}/path/${skilljarPath.slug}`)):logger.warn(`Tried to load ${skilljarPath.slug} path unsuccessfully.`)}function notFoundView(){CG.page.isPartner404&&!CG.env.isLoggedIn&&(Q(".message").append(el("hr"),el("p",{classList:"sj-text-page-not-found-explanation",innerHTML:CG.data.partnerErrorMessage})),window.location.replace(`/auth/login?next=${encodeURIComponent(window.location.pathname)}`))}function authView(){CG.dom.local.auth={rows:[],inputs:{email:Q("#id_email")||Q("#id_login"),password:Q("#id_password")||Q("#id_password1"),password2:Q("#id_password2"),fName:Q("#id_first_name"),lName:Q("#id_last_name"),accessCode:Q("#id_access_code")},forgotPasswordLink:Q("a.forgot-password"),labels:{passwordConfirm:Q("label[for=id_password2] .input-label-text span"),fName:Q("label[for=id_first_name] span span"),lName:Q("label[for=id_last_name] span span"),email:Q("label[for=id_email]")||Q("label[for=id_login]"),accessCode:Q("label[for=id_access_code] span span")},google:Q("#google_login"),TOS:Q("#access-message"),form:Q("#login_form")||Q("#signup_form"),btn:Q("#button-sign-in")||Q("#button-sign-up"),method:Q(".sj-text-sign-in-with")||Q(".sj-text-sign-up-with"),login:Q("#login-tab-left a span")||Q("#login-tab-left span span"),signup:Q("#login-tab-right a")||Q("#login-tab-right span"),get altMethod(){return Q("span",CG.dom.auth.method)}},text(CG.dom.local.auth.login,"Log In"),text(CG.dom.local.auth.signup,"Sign Up"),text(CG.dom.local.auth.google,"Continue with Google"),text(CG.dom.local.auth.btn,CG.page.isLogin?"Log In":"Sign Up"),text(CG.dom.local.auth.labels.email,"Work Email"),placeholder(CG.dom.local.auth.inputs.email,"Work Email"),CG.page.isSignup&&(text(CG.dom.local.auth.labels.fName,"First Name"),text(CG.dom.local.auth.labels.lName,"Last Name"),placeholder(CG.dom.local.auth.inputs.fName,"First Name"),placeholder(CG.dom.local.auth.inputs.lName,"Last Name"),placeholder(CG.dom.local.auth.inputs.password2,"Password Confirm"),text(CG.dom.local.auth.labels.passwordConfirm,"Password Confirm"),text(CG.dom.local.auth.labels.accessCode,"Access Code (optional)"));const e=el("div",{id:"auth-container"},[Q("#tabs"),el("div",{className:"auth-card"},[CG.dom.local.auth.form,el("div",{className:"divider"},[el("span",{textContent:"or"})]),CG.dom.local.auth.google,CG.dom.local.auth.TOS])]);CG.dom.contentContainer.append(e),CG.page.isLogin&&CG.dom.local.auth.inputs.password&&CG.dom.local.auth.inputs.password.parentElement.append(CG.dom.local.auth.forgotPasswordLink),CG.page.isSignup&&(A("input").forEach(e=>{e.getAttribute("id")&&(CG.dom.local.auth.rows[e.getAttribute("id")]=e.closest(".row"),CG.dom.local.auth.rows[e.getAttribute("id")].setAttribute("aria-label",e.getAttribute("id")))}),CG.dom.local.auth.rows.id_password2.insertAdjacentElement("afterend",CG.dom.local.auth.rows.id_access_code),CG.dom.local.auth.inputs.accessCode.addEventListener("focus",()=>{setStyle(CG.dom.local.auth.rows.id_access_code,{opacity:"1"})}),CG.dom.local.auth.inputs.accessCode.addEventListener("blur",()=>{""===CG.dom.local.auth.inputs.accessCode.value&&setStyle(CG.dom.local.auth.rows.id_access_code,{opacity:"0.4"})}),setStyle(CG.dom.local.auth.rows.id_access_code,{opacity:"0.4"})),remove(CG.dom.local.auth.method)}function catalogView(){CG.dom.body.prepend(el("div",{id:"cg-bg"})),CG.data.sections=pathSections[skilljarCatalogPage.slug],CG.data.sections||(CG.data.sections=pathSections.home),pathSections[skilljarCatalogPage.slug]||CG.page.isLanding||logger.warn("Could not determine catalog section name, defaulting to home"),hide(Q("#catalog-content")),remove([".catalog-left-nav","#left-nav-button",".back-to-catalog"]),makeSections(CG.data.sections,"#skilljar-content",CG.state.baseURL),CG.dom.contentContainer.append(el("div",{className:"full-width",id:"cta-bottom"},[createClone("chainguard",{width:"83",height:"72"}),el("h2",{text:"Want to learn more about Chainguard?"}),el("div",{},[el("a",{href:getCorrectURL("https://www.chainguard.dev/contact"),className:"button white",text:"Contact Us"},[createClone("rightArrow")]),createClone("chainguard",{width:"83",height:"72"})])]))}function courseUnregisteredView(){CG.dom.local={card:Q(".course-card")};let e=CG.dom.header.courseInfo||CG.el.headingParagraph;[...e.children].filter(e=>-1!==e.textContent.search(/Course \d+ of \d+ in/)).forEach(e=>e.classList.add("course-order")),[...e.children].filter(e=>-1!==e.textContent.search(/Register for the learning path to register for this course/)).forEach(e=>e.classList.add("path-registration")),"undefined"!=typeof courseDetails&&(CG.dom.local.card&&CG.dom.local.card.remove(),CG.dom.courseContainer.append(...[createCourseDetailsCard(courseDetails,{btnText:CG.dom.header.ctaBtnWrapper?CG.dom.header.registerBtn.textContent:"Register for Learning Path",btnHref:CG.dom.header.href,completed:CG.state.course.completed})].filter(Boolean)));try{CG.dom.curriculumContainer.replaceChildren(...CG.data.curriculumElements)}catch(e){logger.error("Error processing curriculum elements:",e)}}function courseRegisteredView(){CG.dom.local={card:Q(".course-card"),_card:{details:Q(".course-card"),link:Q(".course-card a")},tabs:{container:Q(".tabs"),get curriculumSection(){return Q("section #curriculum-section",this.container)||Q("section:nth-child(1)",this.container)},get aboutSection(){return Q("section #about-section",this.container)||Q("section:nth-child(2)",this.container)}}},CG.dom.local.tabs.aboutSection?.classList.add("active"),CG.dom.local.tabs.container.append(Object.assign(CG.dom.local.tabs.aboutSection,{id:"about-section"}),Object.assign(CG.dom.local.tabs.curriculumSection,{id:"curriculum-section"})),"undefined"!=typeof courseDetails&&(CG.dom.local.card&&CG.dom.local.card.remove(),CG.dom.courseContainer.append(...[createCourseDetailsCard(courseDetails,{btnText:CG.dom.header.ctaBtnWrapper?CG.dom.header.ctaBtnText.textContent:"Resume",btnHref:CG.dom.header.href,completed:CG.state.course.completed})].filter(Boolean)),CG.dom.local._card.link=Q(".course-card a")),CG.dom.header.ctaBtnWrapper&&CG.dom.local._card.link?Object.assign(CG.dom.local._card.link,{textContent:CG.dom.header.ctaBtnText.textContent||"Resume",href:CG.dom.header.ctaBtn.getAttribute("href")||"resume"}):CG.dom.local._card.link&&!CG.state.course.completed&&(logger.warn("Hiding resume button as it could not be found"),hide(CG.dom.local.card.link)),CG.dom.curriculumContainer.replaceChildren(...CG.data.curriculumElements),CG.dom.courseContainer.append(...[CG.dom.local._card.details].filter(Boolean))}function pathUnregisteredView(){tryPathSections()}function pathRegisteredView(){hide([".path-curriculum-resume-wrapper","#path-curriculum-progress-bar-annotation","#path-curriculum-progress-bar"]);const e=el("div",{className:"top-row-grey top-row-white-v2 padding-top padding-side row-v2"},[el("div",{className:"row dp-row-flex-v2"},[el("div",{className:"columns text-center large-6 dp-summary-wrapper text-left-v2"},[el("div",{className:"sj-floater-text",textContent:"Learning Path"}),el("h1",{className:"break-word",textContent:skilljarCourseSeries.title||""}),el("p",{className:"sj-heading-paragraph",textContent:skilljarCourseSeries.short_description||""}),Q(".path-curriculum-button-wrapper a")])])]),t=el("div",{id:"dp-details-bundle"},[el("div",{className:"row padding-side"},[el("div",{className:"columns"},[el("div",{className:"dp-long-description"},[el("p",{innerHTML:skilljarCourseSeries.long_description_html})])])])]);CG.dom.contentContainer.prepend(...[e,t].filter(Boolean)),tryPathSections()}function setupLessonNav(){const e=Q("#lp-footer .prev-lesson-button"),t=Q("#lp-footer .next-lesson-link"),a=e?.getAttribute("href")||"#",o=e?.getAttribute("title")||"Previous Lesson",r=e?.getAttribute("data-track-click"),n=t?.getAttribute("onmouseup")||"",s=t?.getAttribute("onkeydown")||"",l=(n||s).match(/onNextLessonClick\('([^']+)'\)/),i=l?l[1]:null,d=t?.getAttribute("title")||"Next Lesson",c=t?.getAttribute("data-track-click"),u=el("a",{className:"lesson-btn prev",rel:"prev",role:"button",href:a,textContent:"â† Previous",title:o,onclick:e=>e.stopPropagation()});r&&u.setAttribute("data-track-click",r);const p=el("a",{className:"lesson-btn next",rel:"next",role:"button",href:i||"#",textContent:"Next â†’",title:d,tabindex:0,onclick:e=>e.stopPropagation()});function m(e){i&&(e?.preventDefault(),"function"==typeof window.onNextLessonClick?window.onNextLessonClick(i):window.location.href=i)}c&&p.setAttribute("data-track-click",c),p.addEventListener("click",m),p.addEventListener("mouseup",m),p.addEventListener("keydown",e=>{const t=e.key;"Enter"!==t&&" "!==t&&"Spacebar"!==t&&"ArrowRight"!==t||m(e)}),e||(u.style.display="none"),t&&i||(p.style.display="none");const g=el("nav",{className:"lesson-floater",role:"navigation",ariaLabel:"Lesson navigation"});return g.append(u,p),g}function processCodeBlock(e){const t=Q("code",e),a=createClone("copy"),o=t.textContent.trim().replace(/\r?\n\$ /g," && ").replace(/^\$ /g,""),r=el("div",{style:"display: flex; justify-content: end; border-bottom: 1px solid gainsboro; padding: 12px 24px;"}),n=el("div",{textContent:"Copied",style:"position: absolute; top: -24px; right: 10px; text-shadow: none; background-color: var(--answer-option); color: var(--primary-white-hex); padding: 5px 10px; border-radius: 4px; opacity: 0; transition: opacity .2s ease-in;"});r.append(a),e.append(n),e.prepend(r),a.addEventListener("click",toClipboard(o,n)),e.dataset.copyAdded="true"}function lessonView(){if(CG.dom.local={body:{mainContainer:Q("#lp-wrapper"),innerContainer:Q("#lesson-body")},lesson:{body:Q("#lesson-body"),innerBody:Q("#lesson-main-inner"),content:{codeBlocks:new Array(...A("pre:has(code):not(.language-ansi)")),internalCourseWarning:Q("#internal-course-warning"),links:A("sjwc-lesson-content-item a"),resources:{boxes:A("sjwc-lesson-content-item .resource-box"),wrapper:Q("sjwc-lesson-content-item .resource-box .resource-wrapper")}}},nav:{menu:Q("#lp-left-nav"),toggleWrapper:Q("#left-nav-button"),backToCurriculumText:Q("#left-nav-return-text"),backBtn:Q("#returnToOverview")},footer:{container:Q("#lp-footer")}},CG.dom.local.nav.backToCurriculumText&&(text(CG.dom.local.nav.backToCurriculumText,"â† Back to Course Description"),CG.dom.local.nav.menu.prepend(CG.dom.local.nav.backBtn)),CG.dom.local.lesson.content.links.forEach(e=>{e.target="_blank",e.href.includes("chainguard.dev")&&(e.href=getCorrectURL(e.href))}),CG.dom.local.body.mainContainer.append(CG.dom.local.footer.container),CG.dom.local.body.innerContainer.prepend(...[CG.dom.local.lesson.content.internalCourseWarning,CG.dom.local.nav.toggleWrapper].filter(Boolean)),CG.dom.local.nav.toggleWrapper.append(setupLessonNav()),CG.dom.local.lesson.content.codeBlocks.filter(e=>!e.dataset.noCopy&&!e.dataset.copyAdded).forEach(e=>processCodeBlock(e)),Array.from(A("h3.sjwc-section-title")).map(e=>e.classList.remove("sjwc-section-title")),"undefined"!=typeof resources){const e=CG.dom.local.lesson.content.resources.boxes.length;if(void 0!==resources.resources&&0===e){logger.info("No resource boxes found to add resources to. Adding automatically!");const e=el("div",{className:"resource-box"}),t=el("h3",{textContent:"ðŸ“˜ More Resources"}),a=el("div",{className:"resource-wrapper"});e.append(t,a),CG.dom.local.lesson.body.append(e)}if(CG.dom.local.lesson.content.resources&&"undefined"!=typeof resources)if(void 0!==resources.resources&&1===e){const e=resources.resources.map(e=>createResourceCard(e)),t=CG.dom.local.lesson.content.resources.boxes[0];Q(".resource-wrapper",t).replaceChildren(...e)}else void 0!==resources.groups&&CG.dom.local.lesson.content.resources.boxes.forEach(e=>{if(!e.dataset.group)return void logger.warn("Resource box is missing data-group attribute, skipping:",e);const t=resources.groups[e.dataset.group].map(e=>createResourceCard(e)),a=Q(".resource-wrapper",e);resources.groups[e.dataset.group]&&a.replaceChildren(...t)})}}const pageHandlers=[{test:()=>CG.page.isLogin||CG.page.isSignup,handler:authView},{test:()=>CG.page.isCourseUnregistered,handler:courseUnregisteredView},{test:()=>CG.page.isCourseRegistered,handler:courseRegisteredView},{test:()=>CG.page.isPathUnregistered,handler:pathUnregisteredView},{test:()=>CG.page.isPathRegistered,handler:pathRegisteredView},{test:()=>CG.page.isLesson,handler:lessonView},{test:()=>CG.page.isCatalog||CG.page.isLanding,handler:catalogView},{test:()=>CG.page.is404,handler:notFoundView}];function handlePageStyling(){const e=pageHandlers.find(({test:e})=>e());if(e?(logger.info(`Running page styling handler: ${e.handler.name}`),e.handler()):logger.warn("No page styling handler matched for this page."),CG.page.isCoursePage||CG.page.isPathRegistered){const e=renderBreadcrumbs();Q(".top-row-grey").prepend(e),CG.page.isCoursePage&&CG.dom.header.wrapper.append(...[Q(".sj-floater-text")||el("div",{className:"sj-floater-text",text:"Course"}),Q(".break-word"),CG.dom.header.courseInfo||CG.el.headingParagraph,CG.dom.header.ctaBtnWrapper].filter(Boolean))}CG.dom.contentContainer.append(Q("#footer-container")),CG.dom.contentContainer.prepend(Q("#messages")),hide(Q("#ep-footer"))}function fixHeader(){const e=el("div",{id:"to-chainguard"},[el("a",{href:getCorrectURL("https://www.chainguard.dev"),target:"_blank",rel:"noopener noreferrer",title:"Go to chainguard.dev",text:"Go to Chainguard â†’"})]),t=el("header",{id:"mobile-header",class:"headers"},[el("div",{id:"mobile-header-left"},[]),el("div",{id:"mobile-header-right"},[e])]);Q("#main-container").insertBefore(t,CG.dom.bodyHeader.nextSibling),CG.dom.headerRight.insertBefore(e.cloneNode(!0),CG.dom.headerRight.firstChild),CG.dom.mobileHeader={container:t,left:Q("#mobile-header-left"),right:Q("#mobile-header-right")}}document.addEventListener("DOMContentLoaded",()=>{logger.info("CG Desktop Script Loaded"),CG.page.isLesson&&CG.dom.contentContainer.append(Q("#left-nav-button")),CG.dom.headerLeft.replaceChildren(el("div",{id:"logo-wrapper"},[el("a",{className:"header-logo-link focus-link-v2",href:CG.state.baseURL},[CONFIG.logo])])),remove(".search-container"),addCrumb("Home",CG.state.baseURL),CG.env.isAdmin&&debugHeading(),CG.dom.bodyHeader.classList.add("headers"),CG.page.isSignup||CG.page.isLogin||fixHeader(),CG.env.isPartner&&addPartnerMenu(),CG.env.hasCourseSeries&&addCrumb(skilljarCourseSeries.title,`/path/${skilljarCourseSeries.slug}`,!0),CG.env.hasCourse&&addCrumb(skilljarCourse.title,"#"),CG.page.inPartnerPath&&addCrumb("Partner Courses","/page/partners",!0),handlePageStyling(),generateFooter(footerData),showBody()});
//# sourceMappingURL=skilljar-theme-v3.0.min.js.map